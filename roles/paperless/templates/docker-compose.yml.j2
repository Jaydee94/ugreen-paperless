services:
  broker:
    image: "{{ paperless_redis_image }}"
    restart: unless-stopped
    volumes: []

  db:
    image: "{{ paperless_db_image }}"
    restart: unless-stopped
    environment:
      POSTGRES_USER: "{{ paperless_db_user }}"
      POSTGRES_PASSWORD: "{{ paperless_db_password }}"
      POSTGRES_DB: "{{ paperless_db_name }}"
    volumes:
      - "./db:/var/lib/postgresql/data"

  paperless:
    image: "{{ paperless_image }}"
    restart: unless-stopped
    depends_on:
      - db
      - broker
    env_file:
      - .env
    volumes:
      - "./data:/usr/src/paperless/data"
      - "./media:/usr/src/paperless/media"
    ports:
      - "{{ paperless_http_port }}:8000"

networks:
  default:
    name: paperless_net
